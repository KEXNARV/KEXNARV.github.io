<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Iniciar Sesión</title>
    <link rel="stylesheet" href="styles/main.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&display=swap" rel="stylesheet">
    <style>
      .boldonse-regular { font-family: 'Bebas Neue', sans-serif; }
    </style>
    <script src="java/userData.js"></script>
    <script>
      (async () => {
        await userData.load();
        if (sessionStorage.getItem('authenticated')) {
          window.location.href = 'index.html';
        }
      })();
    </script>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen" style="background-image: url('resources/images/background.png'); background-size: cover; background-position: center;">
    <form id="login-form" class="glass p-8 rounded-lg shadow-md w-full max-w-sm">
        <h2 class="text-2xl mb-4 boldonse-regular text-center">Iniciar Sesión</h2>
        <div class="mb-4">
            <label class="block mb-2" for="username">Usuario</label>
            <input type="text" id="username" class="w-full p-2 border rounded" required>
        </div>
        <div class="mb-4">
            <label class="block mb-2" for="password">Contraseña</label>
            <input type="password" id="password" class="w-full p-2 border rounded" required>
        </div>
        <button type="submit" class="w-full bg-blue-600 text-white py-2 rounded">Entrar</button>
    </form>
    <script>
      document.getElementById('login-form').addEventListener('submit', async function(e) {
          e.preventDefault();
          await userData.load();
          const user = document.getElementById('username').value.trim();
          const pass = document.getElementById('password').value;
          const found = userData.users.find(u => u.username === user && u.password === pass && u.active);
          if (found) {
              sessionStorage.setItem('authenticated', 'true');
              sessionStorage.setItem('currentUser', JSON.stringify(found));
              window.location.href = 'index.html';
          } else {
              alert('Credenciales incorrectas');
          }
      });
    </script>
</body>
</html>
